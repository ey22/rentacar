<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        
        <meta charset="UTF-8">
        <style>

        .logoImage{
            position: absolute;
            left: 10px;
            top:1px;
        }
        .title{
            position: absolute;
            background-color: rgb(204, 153, 102,0.3);
            color:black;
            left: 0; 
            width: 100%; 
            height: 100%;
            align-items: center;
        } 
        .white{
            position: absolute;
            background-color: white;
            width: 100%; 
            height: 15%;
            left:0;
            top:0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }
        .brandFilter{
            position: absolute;
            left:3cm;
            top:0;
            display: flex;
            background-color: white;
            height: 1.2cm;
            width: 5cm;
            background-color:rgb(203, 163, 123) ;
            border: 10px;
            border-style:inset;
            border-radius: 10px; 
            cursor: pointer;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #brandFilter {
            padding: 0.5rem;
            border-radius: 4px;
            border: 1px solid #fbf8f8;
            width: 4cm;
            height: 1.1cm;
            font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            font-size:large;
            border-style:inset;
            font-weight: 400;
        }
        .transmissionFilter{
            position: absolute;
            left:10cm;
            top:0;
            display: flex;
            background-color: white;
            height: 1.2cm;
            width: 5cm;
            background-color:rgb(203, 163, 123) ;
            border: 10px;
            border-style:inset;
            border-radius: 10px; 
            cursor: pointer;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #transmissionFilter{
            padding: 0.5rem;
            border-radius: 4px;
            border: 1px solid #fbf8f8;
            width: 4cm;
            height: 1.1cm;
            font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            font-size:large;
            border-style:inset;
            font-weight: 400;
        }
        .whiteBackgroundOfCarTables{
            position: relative;
            top: 20%;
            width: 100%;
            height: auto;
            left:0;
            background-color: white;
            flex-wrap: wrap;            
            display: flex;
            gap: 1rem; 
            padding: 1rem;
            flex-direction: column;  
        }
        .filterSection {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            gap: 1rem; 
            padding-bottom: 1rem;
            border-bottom: 1px solid #ccc; 
            margin-bottom: 1rem;
        }
        .carBox {
            display: flex;
            align-items: center;
            background-color: #e6e6e6;
            width: 95%;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            margin-bottom: 1rem;
            height: 6cm;
        }
        .carBox:hover {
            transform: translateY(-5px);
            cursor: pointer;
        }
        .carImage {
            width: 9cm;
            height: 6cm;
            border-radius: 8px;
            margin-right: 2rem;
        }
        .carInformation {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: medium;
            font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            font-weight: 600;
            justify-content: space-between;
        }     
        .carPrice{
            font-size: x-large;
            font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            font-weight: 600;
            margin-left: auto;
            flex-direction: column;
            
        }
        .selectButton{
            height: 2cm;
            width: 4cm;
            background-color:rgb(203, 163, 123) ;
            border: 10px;
            font-size:x-large;
            border-style:inset;
            font-weight: 500;
            border-radius: 10px; 
            cursor: pointer;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            
        }
       
        .stepper {
            display: flex;
            justify-content: space-around;
            margin: 2rem 0 2rem 8rem;
            background-color: #f5f5f5;
            padding: 0.5rem;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-style:inset;
            
        }
        .stepBox {
            flex: 1;
            text-align: center;
            padding: 1rem;
            cursor: pointer;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f0f0f0;
            transition: all 0.3s ease;
            background-color: rgb(203, 163, 123); 
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; 
            font-weight: 400; 
        }

        .stepBox.active {
            background-color: #ff9900;
            color: white;
            font-weight: 400; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .stepContent {
            display: none;
            padding: 2rem;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            
        }

        .stepContent.active {
            display: block;
        }

        /* Location Selection alanƒ± */
        .locationSelection {
            margin: 1rem 0;
        }

        .selectionLabel {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }
        #locationSelection {
            padding: 0.5rem;
            border-radius: 4px;
            border: 1px solid #ccc;
            width: 100%;
            font-size: 1rem;
        }
        .noCarMessage {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff4d4d; 
            margin-top: 3rem;
            padding: 1rem;
            background-color: #ffe6e6; 
            border-radius: 8px;
            border: 1px solid #ff9999;
            width: 85%; 
            margin-left: auto;
            margin-right: auto;
            top:20cm;
        }
        </style>
        <link rel="icon" href="images/car_icon.png">
    </head>
    <body>
        <div class="title">
            <div id="carContainer" class="whiteBackgroundOfCarTables">  
                <div class="filterSection">
                    <div class="brandFilter">
                        <label for="brandFilter"></label>
                        <select id="brandFilter" onchange="filterCars()" >
                            <option value="" selected disabled>Brand</option>
                            <option value="All">All Brands</option>
                            <option value="Audi">Audi</option>
                            <option value="Peugeot">Peugeot</option>
                            <option value="Volkswagen">Volkswagen</option>
                            <option value="Ford">Ford</option>
                            <option value="Volvo">Volvo</option>
                            <option value="Mercedes">Mercedes</option>
                        </select>
                    </div>
    
                <div class="transmissionFilter">
                    <label for="transmissionFilter"></label>
                    <select id="transmissionFilter" onchange="filterCars()" >
                        <option value="" selected disabled>Transmission Type</option>
                        <option value="All">All Transmission Types</option>
                        <option value="Manuel">Manuel</option>
                        <option value="Automatic">Automatic</option>
                    </select>
                </div>
                <div id="noCarMessage" class="noCarMessage" style="display: none;">
                    There are no cars with the desired specifications. Please try different filters.
                </div>
                </div> 
                <div id="extrasContainer" style="display: none;"></div>

            </div>        

        </div>         
        <div class="white">
            <img class="logoImage" src="./images/Logo.webp" alt="logo of car" style="width: 3.2cm;height:3.2cm;">

            <div class="stepper">
                <div class="stepBox" id="step1">
                    <label for="locationSelection" class="stepLabel">Step 1: Location Selection</label>
                    <select id="locationSelection" class="stepSelect" onchange="handleLocationSelection()">
                        <option value="" selected disabled>Select a location</option>
                        <option value="Istanbul">üìç Istanbul</option>
                        <option value="Berlin">üìç Berlin</option>
                        <option value="Paris">üìç Paris</option>
                        <option value="Roma">üìç Roma</option>
                    </select>
                </div>
            
                <div class="stepBox" id="step2" onclick="switchStep(2)">
                    Step 2: Car Selection
                    
                </div>
            
                <div class="stepBox" id="step3" onclick="switchStep(3)">
                    Step 3: Extras
                </div>
            </div>
        </div>

                <script>
                    function handleLocationSelection() {
                        const location = document.getElementById("locationSelection").value;

                        if (location) {
                            switchStep(2);
                            loadCars();
                        }
                    }
                    async function switchStep(stepNumber) {
                        
                        const stepBoxes = document.querySelectorAll(".stepBox");
                        stepBoxes.forEach(box => box.classList.remove("active"));

                        const currentStep = document.getElementById(`step${stepNumber}`);
                        if (!currentStep) {
                            console.error(`ID 'step${stepNumber}' bulunamadƒ±.`);
                            return; 
                        }
                        currentStep.classList.add("active");

                        if (stepNumber === 1) {
                            document.getElementById("carContainer").style.display = "none";
                            document.getElementById("filterSection").style.display = "block";
                            document.getElementById("extrasContainer").style.display = "none";
                        } else if (stepNumber === 2) {
                            document.getElementById("carContainer").style.display = "block";
                            document.getElementById("filterSection").style.display = "none";
                            loadCars(); 
                        } else if (stepNumber === 3) {
                            document.getElementById("carContainer").style.display = "none";
                            document.getElementById("extrasContainer").style.display = "block";
                        }
                    }
                    
                    async function filterCars() {
                    const brand = document.getElementById("brandFilter").value || "All";;
                    const transmission = document.getElementById("transmissionFilter").value || "All";;
             
                try {
                    const response = await fetch(`http://localhost:8080/cars/filter?brand=${encodeURIComponent(brand)}&transmissionType=${encodeURIComponent(transmission)}`);
                    if (response.ok) {
                        const cars = await response.json();
                        
                        const container = document.getElementById("carContainer");
                        const filterSection = container.querySelector(".filterSection");
                        container.innerHTML = "";
                        container.appendChild(filterSection); 
                        if (cars.length === 0) {
                            const noCarMessage = document.getElementById("noCarMessage");
                            noCarMessage.style.display = "block";
                        } else {
                            noCarMessage.style.display = "none"; 
                            cars.forEach(car => {
                                const carBox = document.createElement("div");
                                carBox.className = "carBox";
                
                                carBox.innerHTML = `
                                    <img class="carImage" src="${car.imageUrl}" alt="${car.name}">
                                    <div class="carInformation">
                                        <h1>${car.name}</h1>
                                        <p>Brand: ${car.brand}</p>
                                        <p>Transmission Type: ${car.transmissionType}</p>
                                        <p>Fuel Type: ${car.fuelType}</p>
                                        </div>
                                        <div class="carPrice">
                                            <p>${car.price} ‚Ç¨/day</p>
                                            <button class="selectButton" id="selectButton" onclick="switchStep(3)">SELECT</button>
                                        </div>
                                    
                                `;
                                container.appendChild(carBox);
                        });
                    }
                    } else {
                        console.error("", response.statusText);
                    }
                } catch (err) {
                    console.error("Error:", err);
                }
            }
      
            async function loadCars() {
                try {
                    const response = await fetch("http://localhost:8080/cars");
                    if (response.ok) {
                        const cars = await response.json();
                        
                        const container = document.getElementById("carContainer");
                        const filterSection = container.querySelector(".filterSection");
                        container.innerHTML = "";
                        container.appendChild(filterSection);
        
                            cars.forEach(car => {
                            const carBox = document.createElement("div");
                            carBox.className = "carBox";

                            carBox.innerHTML = `
                                <img class="carImage" src="${car.imageUrl}" alt="${car.name}">
                                <div class="carInformation">
                                        <h1>${car.name}</h1>
                                        <p>Brand: ${car.brand}</p>
                                        <p>Transmission Type: ${car.transmissionType}</p>
                                        <p>Fuel Type: ${car.fuelType}</p>
                                    </div>
                                    <div class="carPrice">
                                        <p>${car.price} ‚Ç¨/day</p>
                                        <button class="selectButton" onclick="switchStep(3)">SELECT</button>
                                    </div>
                                
                            `;
                            container.appendChild(carBox);
                        });
                    } 
                    else {
                        console.error("", response.statusText);
                    }
                }catch (err) {
                    console.error("Error:", err);
                }
            
            }
         </script>   

        </div> 
        
            
       
    